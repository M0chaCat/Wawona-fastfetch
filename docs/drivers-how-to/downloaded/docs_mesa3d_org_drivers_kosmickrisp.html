<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>KosmicKrisp &#8212; The Mesa 3D Graphics Library latest documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/screen.css?v=10557b77" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=c309799c" />

    <script src="../_static/documentation_options.js?v=91d07486"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="KosmicKrisp workarounds" href="kosmickrisp/workarounds.html" />
    <link rel="prev" title="IR3 NOTES" href="freedreno/ir3-notes.html" />
<script>
  (() => {
    const mq = window.matchMedia('(prefers-color-scheme: dark)');
    const update = (m) => document.documentElement.setAttribute('data-bs-theme', m.matches ? 'dark' : 'light');
    mq.addEventListener('change', (e) => update(e));
    update(mq);
  })();
</script>

  </head>
  <body class="d-flex flex-column h-100">

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark-subtle" data-bs-theme="dark">
    <div class="container">
      <div class="d-flex flex-row">
        <a class="navbar-brand" href="https://www.mesa3d.org/">
          <img class="d-inline-block align-bottom" src="../_static/logo.svg" alt="" width="30" height="30">
          Mesa 3D
        </a>
      </div>

      <button id="navbar-button" class="d-none navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto">

          <li class="nav-item">
            <a class="nav-link" href="https://www.mesa3d.org/" title="Home">Home</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="https://www.mesa3d.org/news/" title="News">News</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="../download.html" title="">Getting Started</a>
          </li>

          <li class="nav-item">
            <a class="nav-link active" href="../index.html" title="">Documentation</a>
          </li>

        </ul>
      </div>
    </div>
    <script>
      document.getElementById('navbar-button').classList.remove('d-none');
      document.getElementById('navbarSupportedContent').classList.add('collapse');
    </script>
  </nav>

  <div class="container my-3">
    <div class="row">
      <main class="body col-12 col-lg-9 order-1 order-lg-2" role="main">
        
  <section id="kosmickrisp">
<h1>KosmicKrisp<a class="headerlink" href="#kosmickrisp" title="Link to this heading">¶</a></h1>
<p>KosmicKrisp is a Vulkan conformant implementation for macOS on Apple Silicon
hardware. It is implemented on top of Metal 4, which requires macOS 26 and up.</p>
<p>No iOS support is present as of now. However, iOS was taken into consideration
during development to support A14 Bionic GPUs and upwards.</p>
<section id="building">
<h2>Building<a class="headerlink" href="#building" title="Link to this heading">¶</a></h2>
<p>The following build instructions assume Homebrew as the package manager to
install dependencies. Homebrew homepage <a class="reference external" href="https://brew.sh/">https://brew.sh/</a>
Homebrew install command line:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>/bin/bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Terminal restart is recommended after Homebrew installation.</p>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Xcode and Xcode command line tools</p></li>
<li><dl class="simple">
<dt>Homebrew packages</dt><dd><ul>
<li><p>meson (1.9.1+, can also be installed as a Python package)</p></li>
<li><p>cmake</p></li>
<li><p>pkg-config</p></li>
<li><p>libclc</p></li>
<li><p>llvm</p></li>
<li><p>spirv-llvm-translator</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Due to potential conflicts, Homebrew will not add <span class="c-expr sig sig-inline c"><span class="n">llvm</span></span> to the path. To add
<span class="c-expr sig sig-inline c"><span class="n">llvm</span></span> to future terminal instances:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PATH=&quot;/opt/homebrew/opt/llvm/bin:$PATH&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.zshrc
</pre></div>
</div>
<p>To add <span class="c-expr sig sig-inline c"><span class="n">llvm</span></span> to current terminal instance:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/opt/homebrew/opt/llvm/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Python</p></li>
<li><dl class="simple">
<dt>Python packages</dt><dd><ul>
<li><p>mako</p></li>
<li><p>packaging</p></li>
<li><p>pyyaml</p></li>
<li><p>meson (1.9.1+, if not installed through Homebrew)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Since Homebrew manages the Python environment, it is encouraged to create a
Python virtual environment and install all packages in that environment. To
create a Python virtual environment (e.g. <code class="docutils literal notranslate"><span class="pre">$HOME/venv_mesa</span></code>):</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span><span class="nv">$HOME</span>/venv_mesa
</pre></div>
</div>
<p>To enable a Python virtual environment:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span><span class="nv">$HOME</span>/venv_mesa/bin/activate
</pre></div>
</div>
</section>
<section id="build-instructions">
<h3>Build instructions<a class="headerlink" href="#build-instructions" title="Link to this heading">¶</a></h3>
<p>Out of tree build directory is recommended.</p>
<p>Once all requirements have been installed, the following command line can be
used to create a debug build:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>meson<span class="w"> </span>setup<span class="w"> </span>&lt;path/to/mesa&gt;<span class="w"> </span>--buildtype<span class="o">=</span>debug<span class="w"> </span>-Dplatforms<span class="o">=</span>macos<span class="w"> </span>-Dvulkan-drivers<span class="o">=</span>kosmickrisp<span class="w"> </span>-Dgallium-drivers<span class="o">=</span><span class="w"> </span>-Dopengl<span class="o">=</span><span class="nb">false</span><span class="w"> </span>-Dzstd<span class="o">=</span>disabled
</pre></div>
</div>
</section>
</section>
<section id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Link to this heading">¶</a></h2>
<p>KosmicKrisp specific environment variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MESA_KK_DEBUG</span></code>: <code class="docutils literal notranslate"><span class="pre">msl</span></code> to log all generated Metal Shading Language (MSL) shaders. <code class="docutils literal notranslate"><span class="pre">force_robustness</span></code> to force robustness on all shaders.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MESA_KK_GPU_CAPTURE</span></code>: Starts Metal capture at device create and ends it at device destroy. Set to <code class="docutils literal notranslate"><span class="pre">1</span></code> to activate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MESA_KK_GPU_CAPTURE_DIRECTORY</span></code>: Metal capture will be saved to the specified directory. Defaults to Xcode if no path is provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MESA_KK_DISABLE_WORKAROUNDS</span></code>: Provide <code class="docutils literal notranslate"><span class="pre">all</span></code> to disable all workarounds. Otherwise, provide a comma separated list to disable wanted workarounds e.g. <code class="docutils literal notranslate"><span class="pre">1,3,4</span></code> to disable workaround 1, 3 and 4.</p></li>
</ul>
</section>
<section id="metal-workarounds">
<h2>Metal workarounds<a class="headerlink" href="#metal-workarounds" title="Link to this heading">¶</a></h2>
<p>Different workarounds are applied throughout the project to avoid issues such
as:</p>
<ul class="simple">
<li><p>Metal API and Vulkan API discrepancies</p></li>
<li><p>Metal bugs</p></li>
<li><p>MSL compiler bugs</p></li>
<li><p>MSL compiler crashes</p></li>
</ul>
<p>These workarounds can be found in:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="kosmickrisp/workarounds.html">KosmicKrisp workarounds</a></li>
</ul>
</div>
</section>
</section>


      </main>

      
      <nav id="menu" class="rounded col-12 col-lg-3 order-2 order-lg-1 bg-dark-subtle pb-3">
        <div class="my-3" role="search">
          <form id="search-form" action="../search.html" method="get">
            <div class="form-group">
              <input class="form-control" type="text" name="q" placeholder="Search docs" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </div>
          </form>
        </div>

        
        
        
          <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">Project History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../amber.html">Amber Branch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../systems.html">Platforms and Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../relnotes.html">Release Notes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Download and Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Downloading and Unpacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Compiling and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../precompiled.html">Precompiled Libraries</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Need help?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lists.html">Mailing Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">Report a Bug</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glsl.html">Shading Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../egl.html">EGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opengles.html">OpenGL ES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../envvars.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../perf.html">Performance Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-perf-tracing.html">GPU Performance Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html">Mesa Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-issues.html">Application Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../viewperf.html">Viewperf Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teflon.html">TensorFlow Lite delegate</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Drivers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="anv.html">ANV</a></li>
<li class="toctree-l1"><a class="reference internal" href="asahi.html">Asahi</a></li>
<li class="toctree-l1"><a class="reference internal" href="d3d12.html">D3D12</a></li>
<li class="toctree-l1"><a class="reference internal" href="freedreno.html">Freedreno</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">KosmicKrisp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building">Building</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-instructions">Build instructions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metal-workarounds">Metal workarounds</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kosmickrisp/workarounds.html">KosmicKrisp workarounds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lima.html">Lima</a></li>
<li class="toctree-l1"><a class="reference internal" href="llvmpipe.html">LLVMpipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="nvk.html">NVK</a></li>
<li class="toctree-l1"><a class="reference internal" href="panfrost.html">Panfrost</a></li>
<li class="toctree-l1"><a class="reference internal" href="powervr.html">PowerVR</a></li>
<li class="toctree-l1"><a class="reference internal" href="radv.html">RADV</a></li>
<li class="toctree-l1"><a class="reference internal" href="svga3d.html">VMware SVGA3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="v3d.html">V3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="vc4.html">VC4</a></li>
<li class="toctree-l1"><a class="reference internal" href="venus.html">Virtio-GPU Venus</a></li>
<li class="toctree-l1"><a class="reference internal" href="virgl.html">VirGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="zink.html">Zink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xlibdriver.html">Xlib Software Driver</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../repository.html">Source Code Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sourcetree.html">Source Code Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities.html">Development Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../helpwanted.html">Help Wanted</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devinfo.html">Development Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codingstyle.html">Coding Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../submittingpatches.html">Submitting Patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust.html">Rust</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasing.html">Releasing Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-calendar.html">Release Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphics-debugging/debugging-misrenderings-crashes.html">Debugging GPU hangs, faults, and misrenderings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dispatch.html">GL Dispatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallium/index.html">Gallium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vulkan/index.html">Vulkan Runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nir/index.html">NIR Intermediate Representation (NIR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spirv/index.html">SPIR-V Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isl/index.html">Intel Surface Layout (ISL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isaspec.html">ISASPEC - XML Based ISA Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rusticl.html">Rusticl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../android.html">Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macos.html">Notes for macOS</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.kernel.org/doc/html/latest/gpu/">Linux Kernel Drivers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Testing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../conform.html">Conformance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/index.html">Continuous Integration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.opengl.org">OpenGL Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://dri.freedesktop.org">DRI Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://planet.freedesktop.org">Developer Blogs</a></li>
</ul>

        
        
      </nav>
      
    </div>
  </div>

  <footer class="footer py-3 bg-body-tertiary text-muted">
    <div class="container">
      <div class="row">

        <div class="col-12 col-lg-3">
          <h6 class="text-body">Documentation</h6>
          <ul class="list-unstyled">
            <li><a href="https://docs.mesa3d.org/license.html">License</a></li>
            <li><a href="https://docs.mesa3d.org/faq.html">FAQ</a></li>
            <li><a href="https://docs.mesa3d.org/download.html">Getting Started</a></li>
          </ul>
        </div>

        <div class="col-12 col-lg-3">
          <h6 class="text-body">Community</h6>
          <ul class="list-unstyled">
            <li><a href="https://gitlab.freedesktop.org/mesa">GitLab</a></li>
            <li><a href="https://docs.mesa3d.org/lists.html">Mailing Lists</a></li>
            <li><a href="https://docs.mesa3d.org/bugs.html">Report a Bug</a></li>
          </ul>
        </div>

        <div class="col-12 col-lg-3">
          <h6 class="text-body">More</h6>
          <ul class="list-unstyled">
            <li><a href="https://www.mesa3d.org/website/">About Mesa3D.org</a></li>
            <li><a href="https://docs.mesa3d.org/thanks.html">Acknowledgements</a></li>
            <li><a href="https://dri.freedesktop.org/wiki/">Mesa / DRI Wiki</a></li>
          </ul>
        </div>

        <div class="col-12 col-lg-3">
          <p>Hosted by <a href="https://www.freedesktop.org/">Freedesktop.org</a></p>
          <p><a href="https://gitlab.freedesktop.org/mesa/mesa/-/blob/main/docs/drivers/kosmickrisp.rst">Edit this page</a></p>
        </div>

      </div>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <script>
  (() => {
    const collapseElementList = document.querySelectorAll('#menu > .caption + ul');
    // Add Bootstrap collapse components to the expandable menu-captions
    [...collapseElementList].forEach(collapseEl => {
      // disable transition if we need toggling
      const toggle = collapseEl.classList.contains('current');
      if (toggle)
        collapseEl.style.transition = "none";
      else
        collapseEl.previousElementSibling.classList.add('collapsed');

      // enable collapse
      collapseEl.classList.add('collapse');
      collapseEl.previousElementSibling.classList.add('collapse-icon');
      const collapse = new bootstrap.Collapse(collapseEl, {
        toggle: toggle
      });

      // disable transition-override again
      if (toggle) {
        collapseEl.addEventListener('shown.bs.collapse', event => {
          collapseEl.style.removeProperty('transition');
        }, {once : true})
      }

      // collapse on click on previous element
      collapseEl.previousElementSibling.addEventListener('click', (event) => {
        collapse.toggle();
        collapseEl.previousElementSibling.classList.toggle('collapsed');
      });
    });
  })();
  </script>

  </body>
</html>